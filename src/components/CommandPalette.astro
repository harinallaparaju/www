---
let open = false;
---

<div id="command-palette" class="hidden fixed inset-0 z-[100] items-center justify-center bg-black/50 backdrop-blur-sm transition-opacity">
  <div
    class="bg-white w-[90vw] max-w-md rounded-2xl shadow-lg overflow-hidden"
    onClick={(e) => e.stopPropagation()}
  >
    <!-- Search input -->
    <div class="border-b border-neutral-200 p-3">
      <input
        id="command-search"
        type="text"
        placeholder="Search blog, books, papers..."
        class="w-full bg-transparent outline-none text-sm text-neutral-800"
        autofocus
      />
    </div>

    <!-- Results container -->
    <div id="command-results" class="max-h-[60vh] overflow-y-auto p-4 text-sm text-neutral-600">
      <p class="text-center text-neutral-400 py-6">Start typing to search.</p>
    </div>
  </div>
</div>

<script>
  const palette = document.getElementById('command-palette');
  const input = document.getElementById('command-search');
  const results = document.getElementById('command-results');

  function togglePalette() {
    palette.classList.toggle('hidden');
    if (!palette.classList.contains('hidden')) {
      input.value = '';
      results.innerHTML = `<p class="text-center text-neutral-400 py-6">Start typing to search.</p>`;
      input.focus();
    }
  }

  document.addEventListener('keydown', (e) => {
    if ((e.metaKey || e.ctrlKey) && e.key.toLowerCase() === 'k') {
      e.preventDefault();
      togglePalette();
    }
    if (e.key === 'Escape') palette.classList.add('hidden');
  });

  // Optional click outside to close
  palette.addEventListener('click', () => palette.classList.add('hidden'));

  // Input typing effect (placeholder until Fuse.js)
  input.addEventListener('input', (e) => {
    const value = e.target.value.trim();
    if (!value) {
      results.innerHTML = `<p class="text-center text-neutral-400 py-6">Start typing to search.</p>`;
      return;
    }
    results.innerHTML = `<p class="text-center text-neutral-500 py-6">Searching for "<strong>${value}</strong>"...</p>`;
  });
</script>

<style>
  @keyframes fadeIn {
    from { opacity: 0; transform: scale(0.98); }
    to { opacity: 1; transform: scale(1); }
  }
  #command-palette:not(.hidden) {
    display: flex !important;
    animation: fadeIn 0.18s ease-out forwards;
  }
</style>
