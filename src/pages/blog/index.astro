---
// blog/index.astro
import Layout from '../../components/Layout.astro';
import IndexIcon from '../../components/icons/Index.astro';

// Get all markdown files and sort by date (newest first)
const posts = await Astro.glob('./*.md');
const sortedPosts = posts.sort((a, b) =>
  new Date(b.frontmatter.pubDate).getTime() - new Date(a.frontmatter.pubDate).getTime()
);

// Format dates
const formatDate = (dateString: string) => {
  const date = new Date(dateString);
  return date.toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
};
---

<Layout>
  <main class="mt-12">
    <!-- Clean header with navigation -->
    <header class="mb-6">
      <div class="flex items-center gap-4 mb-8">
        <a
          href="/"
          class="flex items-center text-neutral-500 hover:text-neutral-800 transition-colors text-base font-light"
        >
          <IndexIcon />
          <span class="ml-1">Index</span>
        </a>
        <span class="text-neutral-300">|</span>
        <h1 class="text-2xl font-medium text-neutral-900">Blog</h1>
      </div>
    </header>

    <!-- Blog posts list -->
    <section class="space-y-8">
      {sortedPosts.map(post => (
        <article class="group">
          <a
            href={post.url}
            class="block hover:no-underline"
          >
            <h2 class="text-xl font-light text-neutral-900 group-hover:text-neutral-600 transition-colors">
              {post.frontmatter.title}
            </h2>
            <time class="text-sm text-neutral-500 font-light">
              {formatDate(post.frontmatter.pubDate)}
            </time>
          </a>
        </article>
      ))}
    </section>
  </main>
</Layout>